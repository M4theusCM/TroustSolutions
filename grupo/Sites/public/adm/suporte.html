<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suporte</title>
    <link rel="icon" type="image/x-icon" href="../src/Logo-icon.png">
    <link rel="stylesheet" href="../css/admin.css">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Chewy&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');

        body {
            font-family: "Poppins", sans-serif;
        }
    </style>
</head>

<body>
    <div class="container-area">
        <div class="menu-lateral">a</div>
        <div class="container">
            <div class="titulo">
                <div>
                    <h1>Suporte</h1>
                </div>
            </div>
            <div class="area-nome">
                <p>Bom dia João Pedro</p>
            </div>
            <div class="area-cards">
                <div class="card jira-card">
                    <a href="https://troustsolutions.atlassian.net/jira/servicedesk/projects/TS/queues/custom/4?atlOrigin=eyJpIjoiNmJjZWMwZWEwM2U1NDA1MGIyODIwZjAxYTUwZjFiMzgiLCJwIjoiaiJ9"
                        class="jira tipo-card" target="_blank">
                        <div class="titulo">
                            <h2>Jira - Help Desk</h2>
                        </div>
                        <div class="infos">
                            <img src="../src/logos/jira.png" alt="Jira">
                        </div>
                    </a>
                </div>
                <div class="card trello-card">
                    <a href="https://trello.com/b/fy7P32D4" class="trello tipo-card" target="_blank">
                        <div class="titulo">
                            <h2>Trello</h2>
                        </div>
                        <div class="infos">
                            <img src="../src/logos/trello.png" alt="trello">
                        </div>
                    </a>
                </div>
                <div class="card tanque-card">
                    <div onclick="addTanque()" class="tanque tipo-card" target="_blank">
                        <div class="titulo">
                            <h2>Adicionar Tanque</h2>
                        </div>
                        <div class="infos">
                            <img src="../src/icons/tanque.png" alt="tanque">
                        </div>
                    </div>
                </div>
                <div class="card tanque-card">
                    <div onclick="exibirEmpresas()" class="empresas tipo-card" target="_blank">
                        <div class="titulo">
                            <h2>Exibir Empresas</h2>
                        </div>
                        <div class="infos">
                            <img src="../src/icons/companhia.png" alt="tanque">
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <div class="bob">
            <img class="bob-ia" id="bob_ia_icon" onclick="openChat()" src="../src/bob_logo.png" alt="">
            <div class="chat" id="chat_bob_user">
                <div class="topo">
                    <div>
                        <img class="bob-ia-chat" src="../src/bob_logo.png" alt="bob">
                        <p>Bob-IA</p>
                    </div>
                    <img onclick="fecharChat()" class="fechar-chat" src="../src/botao-fechar.png" alt="">
                </div>
                <div class="area-msgs">
                    <div class="msg-bob">
                        <div class="msg">
                            Olá JP, como posso ajudar?
                        </div>
                    </div>
                    <div class="msg-user">
                        <div class="msg">Sua duvida aq</div>
                    </div>
                </div>
                <div class="area-ipt">
                    <div class="ipt">
                        <input type="text" id="ipt_msg">
                        <img onclick="enviarPergunta()" src="../src/mandar.png" alt="Enviar">
                    </div>
                </div>
            </div>
        </div>


        <div id="idModal" class="area-modal">

        </div>
    </div>
</body>
<script>
    function openChat() {
        bob_ia_icon.style.display = 'none'
        chat_bob_user.style.display = 'block'
    }
    function fecharChat() {
        bob_ia_icon.style.display = 'block'
        chat_bob_user.style.display = 'none '
    }
    function addTanque() {
        idModal.style.display = 'flex'
        idModal.innerHTML = `
            <div class="modal" id="modal_card">
                <div class="ipts">
                    <div class="titulo-modal">
                        <img src="../src/botao-fechar.png" onclick="fecharModal()" alt="Fechar">
                        <h1>Adicionar tanque</h1>
                    </div>
                    <div class="dados">
                        <div class="linha">
                            <label>
                                <span>Nome Tanque:</span>
                                <input type="text" id="ipt_nome_tanque">
                            </label>
                        </div>
                        <div class="linha">

                            <label>
                                <span>Setor Tanque:</span>
                                <input type="text" id="ipt_setor_tanque">
                            </label>
                        </div>
                        <div class="linha">
                            <label>
                                <span>Tamanho do tanque em M²</span>
                                <input type="number" id="ipt_mts">
                            </label>
                            <label>
                                <span>Litragem do tanque</span>
                                <input type="number" id="ipt_litragem">
                            </label>
                        </div>
                        <div class="linha">
                            <label>
                                <span>Temp. Máxima Tanque:</span>
                                <input type="number" id="ipt_temp_max_tanque">
                            </label>
                            <label>
                                <span>Temp. Minina Tanque:</span>
                                <input type="number" id="ipt_temp_min_tanque">
                            </label>
                        </div>

                        <div class="linha">
                            <label>
                                <span>Código da empresa:</span>
                                <input type="text" id="ipt_cod_empresa">
                            </label>
                        </div>
                    </div>
                    <div class="enviar">
                        <button onclick="salvarTanque()">Salvar</button>
                    </div>
                </div>
                <div class="img">
                    <img src="../src/icons/tanque.png" alt="Tanque">
                </div>
            </div>
        `
    }
    function fecharModal() {
        idModal.innerHTML = ''
        idModal.style.display = 'none'
    }

    function salvarTanque() {
        var nomeTanque = ipt_nome_tanque.value
        var setorTanque = ipt_setor_tanque.value
        var mtsTanque = Number(ipt_mts.value)
        var litragemTanque = Number(ipt_litragem.value)
        var tempMaxTanque = Number(ipt_temp_max_tanque.value)
        var tempMinTanque = Number(ipt_temp_min_tanque.value)
        var codEmpresa = ipt_cod_empresa.value

        fetch("/empresas/cadastrarTanqueEmpresa", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                nomeTanqueServer: nomeTanque,
                setorTanqueServer: setorTanque,
                metragemTanqueServer: mtsTanque,
                litragemTanqueServer: litragemTanque,
                tempMaxTanqueServer: tempMaxTanque,
                tempMinTanqueServer: tempMinTanque,
                codEmpresaServer: codEmpresa
            })
        })
            .then(function (resposta) {
                console.log('Cadastrado eu acho: ' + resposta)
                if (resposta.ok) {
                    ipt_nome_tanque.value = ''
                    ipt_setor_tanque.value = ''
                    ipt_mts.value = ''
                    ipt_litragem.value = ''
                    ipt_temp_max_tanque.value = ''
                    ipt_temp_min_tanque.value = ''
                    ipt_cod_empresa.value = ''
                    fecharModal()
                } else {
                    console.error("Deu ruim ")
                }
            })
            .catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
            });

    }

    function exibirEmpresas() {
        idModal.style.display = 'flex'
        fetch("/empresas/buscarEmpresasCad")
            .then(function (resposta) {
                // console.log('resposta: ' + resposta)
                if (resposta.ok) {
                    resposta.json().then(function (empresas) {
                        var qtdEmpresas = empresas.length
                        // console.log(JSON.stringify(empresas))
                        var msgEmpresas = ''
                        for (var i = 0; i < qtdEmpresas; i++) {
                            var empresaAtual = empresas[i]
                            console.log(empresaAtual)
                            if (i % 2 == 0) {
                                msgEmpresas += `
                                <tr class="l1">
                                    <td>${empresaAtual.nomeFantasia}</td>
                                    <td>${empresaAtual.codigo}</td>
                                </tr>
                             `
                            } else {
                                msgEmpresas += `
                                <tr>
                                    <td>${empresaAtual.nomeFantasia}</td>
                                    <td>${empresaAtual.codigo}</td>
                                </tr>
                             `
                            }
                        }
                        var msg = ` <div class="modal modal-empresa" id="modal_card">
                                    <div class="titulo-modal">
                                        <img src="../src/botao-fechar.png" onclick="fecharModal()" alt="Fechar">
                                        <h1>Empresas Cadastradas</h1>
                                    </div>
                                    <div class="area-empresas">
                                        <table>
                                            <tr>
                                                <th>Nome Fantasia</th>
                                                <th>Código</th>
                                            </tr>
                                        ${msgEmpresas}
                                        </table>
                                    </div>
                                </div>`
                        idModal.innerHTML = msg
                    })
                } else {
                    console.log('Erro ao buscar as resposta')
                }
            })
    }

</script>

</html>